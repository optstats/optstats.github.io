<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Lecture 1 Introduction to Optimal Transport - optstats</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Lecture 1 Introduction to Optimal Transport">
<meta itemprop="description" content="Optimal Transport Course from NJIT."><meta itemprop="datePublished" content="2022-09-02T04:56:58+05:30" />
<meta itemprop="dateModified" content="2022-09-02T04:56:58+05:30" />
<meta itemprop="wordCount" content="754">
<meta itemprop="keywords" content="B.Hamfeldt,Optimal Transport,MATH 707," /><meta property="og:title" content="Lecture 1 Introduction to Optimal Transport" />
<meta property="og:description" content="Optimal Transport Course from NJIT." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://optstats.github.io/2022/09/lecture-1-introduction-to-optimal-transport/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-02T04:56:58+05:30" />
<meta property="article:modified_time" content="2022-09-02T04:56:58+05:30" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Lecture 1 Introduction to Optimal Transport"/>
<meta name="twitter:description" content="Optimal Transport Course from NJIT."/>
<link rel="stylesheet" type="text/css" media="screen" href="https://optstats.github.io/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://optstats.github.io/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://optstats.github.io/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://optstats.github.io/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://optstats.github.io/">
				<img src="/icon.jpeg" alt="optstats" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://optstats.github.io/">optstats</a></h1>
	<div class="site-description"><p>Notebooks</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/optstats" title="Github"><i data-feather="github"></i></a></li></ul>
		</nav>
		
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All posts</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


    
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css"
    integrity="sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5"
    crossorigin="anonymous">

<script defer
    src="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js"
    integrity="sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd"
    crossorigin="anonymous"></script>

<script defer
    src="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js"
    integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"
    crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
            ],
            throwOnError : false
        });
    });
</script>






		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">02</span>
							<span class="rest">Sep 2022</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Lecture 1 Introduction to Optimal Transport</h1>
				</div>
			</div>

			
			
			<aside class="toc">
				<header>
				<h2>Contents</h2>
				</header>
				<nav id="TableOfContents">
  <ol>
    <li><a href="#monge-problem">Monge Problem</a>
      <ol>
        <li><a href="#background">Background</a></li>
        <li><a href="#optimal-mapping">Optimal Mapping</a></li>
      </ol>
    </li>
    <li><a href="#kantorovich-formulation">Kantorovich Formulation</a>
      <ol>
        <li><a href="#monotone-in-1d-case">monotone in 1D case</a></li>
      </ol>
    </li>
  </ol>
</nav>
			</aside>
			
					
			<div class="markdown">
				<h2 id="monge-problem">Monge Problem</h2>
<h3 id="background">Background</h3>
<ol>
<li>To transport a pile of sand into some holes, such as from point $x$ to $T(x)$;</li>
<li>We concern which in an efficient way to transport formulated with cost $x-T(x)$;</li>
<li>The over all transport formulated by $\int [x-T(x)]f(x)dx$;
<ul>
<li>We could understand the formula above in this way, the $x-T(x)$ denotes the unit mass transport cost, the $f(x)$ denotes the mass on opint x, so the whole transport cost on point $x$ is $[x-T(x)]f(x)$.Therefore, the overall cost to minimize is</li>
</ul>
</li>
</ol>
<p>$$\lim\limits_{n\to\infty}\sum_{i=1}^n[x_i-T(x_i)]f(x_i)=\int [x-T(x)]f(x)dx$$</p>
<ol start="4">
<li>
<p>To consider other costs $c(x,y)$ the optimization problem is,
$$min\ \int c(x,y)f(x)dx$$</p>
</li>
<li>
<p>Generally, the transformed object are measures, the source measure $u(E)$ and the target $v(E)$ respectively. Noting the mean of measure, the $u(E)$ tell us how much mass is in set E,whch is the subset of $R^n$.</p>
</li>
<li>
<p>The transport is mass balance, i.e. $u(R^n)=v(R^n)$.</p>
</li>
</ol>
<h3 id="optimal-mapping">Optimal Mapping</h3>
<ol>
<li>We seek a transport map $T(x)$ to map source to target, the source supported on $X$ and the target supported on $Y$, where we assume the $X$ and $Y$ are subset of $R^n$.</li>
</ol>
<p>$$T: X \rightarrow Y $$</p>
<ol start="2">
<li>We want to conserve mass not just globally but also locally. For any set $A$ in $Y$, which comes from the set $T^{-1}(A)$ in $X$ and as we need conserve the mass, therefore,</li>
</ol>
<p>$$u(T^{-1}(A))=v(A)\ \forall A\subseteq Y$$</p>
<ol start="3">
<li>
<p>$u(T^{-1}(A))$ defines the operation pushforward of $u$ through $T$, denoted as $T_{\sharp}u$.</p>
</li>
<li>
<p>As with mass conservation, the pushforward is  measure preservation, $T_{\sharp}u=v$. Also we could think the measure as the mass on set.</p>
</li>
<li>
<p>The Monge formulation</p>
</li>
</ol>
<p>$$min\ \lbrace\int_{R^n} c(x,T(x))du(x)|T_{\sharp}u=v\rbrace $$</p>
<ol start="6">
<li>
<p>The some questions for Monge formulation:</p>
<ul>
<li>Is there a minimiser?</li>
<li>Is it unique?</li>
<li>Stability?</li>
<li>Is it feasible?</li>
<li>Can we compute the solution? If there is, how do we compute it.</li>
</ul>
</li>
<li>
<p>Book moving problem</p>
<ul>
<li>The problem is move two adjacent book to next location, noting the next assumption.</li>
<li>Non-uniqueness: If the cost is $c(x,y)=|x-y|$, there are two mass-preserving plans, both have a cost of 2.</li>
<li>Unique solution: If the cost is $c(x,y)=\frac{1}{2}|x-y|^2$, also the quadratic cost is much easier.</li>
</ul>
</li>
<li>
<p>Non-uniqueness: Considering there are four points, two dot points and two product points, there are two different rearrange plans and there are no difference on cost, even for quadratic cost.</p>
</li>
<li>
<p>Feasibility: Considering there is one source point with mass 1 and two target points with the same needed mass $\frac{1}{2}$, where we could not find one map to do this work simultaneously under the mass preserving constraint.
So we need to allow the mass to split.</p>
</li>
</ol>
<h2 id="kantorovich-formulation">Kantorovich Formulation</h2>
<ol>
<li>
<p>We seek a transport plan(not map) that allow mass to split, also meet the constraints of Monge problem.</p>
</li>
<li>
<p>We need to konw how much mass moved from x to y, where we store this in a measure $\pi$ defined on $X\ast Y$.</p>
</li>
<li>
<p>In general, if $A\subset X$ and $B\subset Y$, the $\pi(A,B)$ tells us how much mass transported from $A$ to $B$.</p>
</li>
<li>
<p>We still need to conserve mass, choose some $x\in X$, we have $\pi(x,Y)=u(x)$.</p>
</li>
<li>
<p>More generally, not just for the point $x$, we could do above for a set. Therefore, if $A\subset X$, then $\pi(A,Y)=u(A)$, where we say the $u$ is the marginal of $\pi$ on $X$. Also we need $v$  to be the marginal of $\pi$ on $Y$, if $B\subset Y$, then $\pi(X,B)=v(B)$.</p>
</li>
<li>
<p>The transport map may not be found but we always could find a transport plan as long as one meet the mass balance, where the two marginal of $\pi$ are $u$ and $v$ respectively.</p>
</li>
</ol>
<p>$$inf\lbrace \int_{X\ast Y} c(x,y)d\pi(x,y) | \pi\in\Pi(u,v))\rbrace$$</p>
<ol start="7">
<li>
<p>The Kantorovich formulation is linear about constraint $\pi$ but the Monge formulation is non-linear for the constraint.</p>
</li>
<li>
<p>Some special cases:</p>
<ul>
<li>Discrete OT: Dirac masses to Dirac Masses</li>
<li>Continuous OT: $u$ and $v$ are absolutely continuous with densities $f,g$.</li>
<li>Semi-discrete OT: $u$ is absolutely cts and $v$ consists of Diracs.</li>
</ul>
</li>
</ol>
<h3 id="monotone-in-1d-case">monotone in 1D case</h3>
<ol start="9">
<li>
<p>Let&rsquo;s Find $T(x)$ in quadratic cost and $1$-$D$ to minimize:
$$\frac{1}{2}\int_R (x-T(x))^2f(x)dx$$
$$s.t. \int_{T^{-1}(A)}f(x)dx=\int_{A}g(y)dy$$</p>
<p>Alternatively,</p>
</li>
</ol>
<p>$$\int_X h(T(x))f(x)dx=\int_Yh(y)g(y)dy\ \forall h\in CTS(x)$$</p>
<ol start="10">
<li>When the transport is optimal in above setting, we could find the transport map $T$ is monotone.
<ul>
<li>Let&rsquo;s pick two points $x_1$ and $x_2$, $\epsilon \geq 0$ and make two little open interval $I_1$ and $I_2$.</li>
<li>$\int_{I_1}f(x)dx=\epsilon=\int_{I_2}f(x)dx,\ x_1\in I_1,\ x_2\in I_2$;</li>
<li>Let $y_i=T(x_i)$ and $J_i=T(I_i)$, where the $J$ is the interval containing $y$</li>
<li>Let&rsquo;s set a new mass-preserving map $\tilde T$, where $\tilde T(x_1)=y_2$,$\tilde T(x_2)=y_1$, $\tilde T(I_1)=J_2$ and $\tilde T(I_2)=J_1$.</li>
<li>$\tilde T(x)=T(x)$, if $x\notin I_1\cup I_2$</li>
<li>As $T$ is optimal, we have</li>
</ul>
</li>
</ol>
<hr>
<p>$$\frac{1}{2}\int_R (x-T(x))^2f(x)dx\leq \frac{1}{2}\int_R(x-\tilde T(x))f(x)dx$$</p>
<p>$$-\int_{I_1} xT(x)f(x)dx-\int_{I_2}xT(x)f(x)dx\leq -\int_{I_1} x\tilde T(x)f(x)dx-\int_{I_2}x\tilde T(x)f(x)dx$$</p>
<p>$$\frac{1}{\epsilon}\int_{I_1}x(\tilde T(x)-T(x))f(x)dx+\frac{1}{\epsilon}\int_{I_2}x(\tilde T(x)-T(x))f(x)dx\leq 0$$</p>
<hr>
<p>As $\epsilon\rightarrow 0$, we have
$$x_1(y_2-y_1)+x_2(y_1-y_2)\leq 0$$</p>
<p>$$(y_2-y_1)(x_2-x_1)\geq 0$$</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li class="tag-li"><a href="/tags/b.hamfeldt">B.Hamfeldt</a></li>
							
							<li class="tag-li"><a href="/tags/optimal-transport">Optimal Transport</a></li>
							
							<li class="tag-li"><a href="/tags/math-707">MATH 707</a></li>
							
						</ul>
					
				
			</div>

			
			
			<div class="back">
				<a href="https://optstats.github.io/"><span aria-hidden="true">← Back</span></a>
			</div>
			

			<div class="back">
				
			</div><div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'optstats-github-io';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the </a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
		
	</div>
	
	<div class="footer wrapper">
	<nav class="nav">
		<div>2022  © Copyright notice </div>
		
	</nav>
</div><script>feather.replace()</script>
</body>
</html>
